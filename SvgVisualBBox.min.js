/*! SvgVisualBBox.js v1.1.3 | MIT License | https://github.com/Emasoft/SVG-BBOX */
var FJ=(o,d)=>()=>(d||o((d={exports:{}}).exports,d),d.exports);var kJ=FJ((zJ,t)=>{(function(o,d){if(typeof define==="function"&&define.amd)define([],d);else if(typeof t==="object"&&t.exports)t.exports=d();else o.SvgVisualBBox=d()})(typeof self<"u"?self:zJ,()=>{let d=new WeakMap;function r(J){return Boolean(J&&/^auto_id_/.test(J))}function n(J){if(!J)return"null/undefined element";let K=[],Q=J.tagName||J.nodeName||"unknown";if(K.push(`<${Q}>`),J.id){let $=r(J.id)?`id="${J.id}" (AUTO-GENERATED - not in original SVG!)`:`id="${J.id}"`;K.push($)}if(J.getAttribute&&J.getAttribute("class"))K.push(`class="${J.getAttribute("class")}"`);let Z=J.parentNode;if(Z&&Z instanceof Element){let $=Z.id?r(Z.id)?` id="${Z.id}" (AUTO-GENERATED)`:` id="${Z.id}"`:"";K.push(`(child of <${Z.tagName}>${$})`)}return K.join(" ")}function qJ(J){if(!J)return;try{let Q=new XMLSerializer().serializeToString(J),Z=new Date().toISOString().replace(/[:.]/g,"-").replace("T","_").slice(0,-5),$=J.id||"svg";if(typeof window<"u")window.__DEBUG_SVG_DATA__={content:Q,filename:`${$}_debug_${Z}.svg`,timestamp:Z}}catch(K){}}function s(J,K){let Q=J&&J.id&&r(J.id),Z=J&&J.parentNode&&J.parentNode instanceof Element&&J.parentNode.id&&r(J.parentNode.id),$=K&&K.id&&r(K.id);if(!Q&&!Z&&!$)return"";qJ(K);let S=J&&J.id?J.id:"(none)",E=new Date().toISOString().replace(/[:.]/g,"-").replace("T","_").slice(0,-5),z=`${K&&K.id?K.id:"svg"}_debug_${E}.svg`;return`
`+`⚠️  AUTO-GENERATED ID WARNING:
`+`   The IDs shown above were automatically assigned by sbb-extract.cjs.
   These IDs DO NOT EXIST in your original SVG file!

`+`   \uD83D\uDD0D DEBUG SVG WILL BE AUTOMATICALLY SAVED:
`+`   ${z}

   To find this element in your original SVG:
   1. Open the debug SVG file (saved automatically in current directory)
   2. Search for the ID "${S}" to locate the problematic element
   3. Note the element's position, visual appearance, and attributes
   4. Find the corresponding element in your original SVG using these details
`}function e(J){if(!J||typeof window>"u"||!window.getComputedStyle)return"unknown";try{let K=window.getComputedStyle(J);return K.fontFamily||K.getPropertyValue("font-family")||"default"}catch{return"error detecting font"}}async function JJ(J,K){if(!J)J=document;if(typeof K!=="number"||!isFinite(K))K=5000;let Q=J.fonts;if(!Q||!Q.ready)return;let Z=Q.ready;if(K<=0){await Z;return}await Promise.race([Z,new Promise(($)=>setTimeout(()=>{$(void 0)},K))])}function KJ(J,K,Q){let Z=K.width/Q.width,$=K.height/Q.height,E=(J.getAttribute("preserveAspectRatio")||"xMidYMid meet").trim().split(/\s+/).filter((f)=>f!=="defer");if(E.length===1&&E[0]==="none")return{scaleX:Z,scaleY:$,offsetX:0,offsetY:0,uniform:!1};let C=E[0]||"xMidYMid",z=E[1]||"meet",N;if(z==="slice")N=Math.min(Z,$);else N=Math.max(Z,$);let L=K.width/N,H=K.height/N,_=Q.width-L,O=Q.height-H,T=0,G=0;if(C.startsWith("xMid"))T=_/2;else if(C.startsWith("xMax"))T=_;if(C.includes("YMid"))G=O/2;else if(C.includes("YMax"))G=O;return{scale:N,offsetX:T,offsetY:G,uniform:!0}}function GJ(J){try{let K=J.getBoundingClientRect(),Q=J.ownerSVGElement||(J instanceof SVGSVGElement?J:null);if(!Q||!K)return null;if(K.width===0&&K.height===0)return null;let Z=Q.getBoundingClientRect(),$=Q.viewBox&&Q.viewBox.baseVal;if(!$||$.width<=0||$.height<=0)return null;if(Z.width<=0||Z.height<=0)return null;let S=KJ(Q,$,Z),E,C,z,N;if(S.uniform){let L=S.scale;E=$.x+(K.left-Z.left-S.offsetX)*L,C=$.y+(K.top-Z.top-S.offsetY)*L,z=K.width*L,N=K.height*L}else E=$.x+(K.left-Z.left)*S.scaleX,C=$.y+(K.top-Z.top)*S.scaleY,z=K.width*S.scaleX,N=K.height*S.scaleY;if(!isFinite(E)||!isFinite(C))return null;if(!isFinite(z)||!isFinite(N))return null;return{x:E,y:C,width:z,height:N}}catch{return null}}async function QJ(J,K,Q,Z){if(!J)throw Error("rasterizeSvgElementToBBox: element parameter is null or undefined");if(!K)throw Error("rasterizeSvgElementToBBox: svgRoot parameter is null or undefined");if(!Q||typeof Q!=="object")throw Error("rasterizeSvgElementToBBox: roi parameter must be an object with x, y, width, height");if(Q.width<=0||Q.height<=0)return null;if(typeof Z!=="number"||Z<=0||!isFinite(Z))throw Error(`rasterizeSvgElementToBBox: pixelsPerUnit must be a positive finite number, got: ${Z}`);let $=Q,S=!!J.id,E;if(!S)E="__svg_visual_bbox_tmp_"+Math.random().toString(36).slice(2),J.id=E;let C=K.cloneNode(!0);if(!S)J.removeAttribute("id");if(!C.getAttribute("xmlns"))C.setAttribute("xmlns","http://www.w3.org/2000/svg");C.setAttribute("viewBox",$.x+" "+$.y+" "+$.width+" "+$.height);let z=16384,N=Math.max(1,Math.round($.width*Z)),L=Math.max(1,Math.round($.height*Z)),H=Z,_=N,O=L;if(N>z||L>z){let Y=z/N,F=z/L,k=Math.min(Y,F);H=Z*k,_=Math.max(1,Math.round($.width*H)),O=Math.max(1,Math.round($.height*H))}C.setAttribute("width",String(_)),C.setAttribute("height",String(O)),C.setAttribute("preserveAspectRatio","none"),C.removeAttribute("x"),C.removeAttribute("y");let T;if(J===K)T=C;else{let Y=E||J.id;T=C.getElementById(Y)}if(!T){let Y=n(J),F=E?`Temporary ID used: "${E}"`:`Element ID: ${J.id?`"${J.id}"`:"(none)"}`,k=s(J,K);throw Error(`❌ Cannot render SVG element: Element not found in cloned SVG
`+`
ELEMENT DETAILS:
  ${Y}
  ${F}
  SVG Root: ${K.id?`id="${K.id}"`:"(no id)"}
`+k+`
This typically happens when:
  1. The element IS the SVG root itself (not supported - query a child element instead)
  2. The element was removed or modified during cloning
  3. The element's ID conflicts with another element

How to fix:
`+`  • If querying the root <svg>, query a child element instead
`+`  • Ensure the element has a unique 'id' attribute
`+`  • Check that the element exists in the DOM before calling this function
`+"  • Verify the element hasn't been dynamically removed")}let G=new Set,f=T;while(f){if(G.add(f),f===C)break;f=f.parentNode}(function Y(F){G.add(F);let k=F.children;for(let W=0;W<k.length;W++){let y=k[W];if(y)Y(y)}})(T),function Y(F){let k=F.getAttribute&&F.getAttribute("xlink:href"),W=F.getAttribute&&F.getAttribute("href");for(let U of[k,W])if(U&&U.startsWith("#")){let I=U.substring(1),M=C.getElementById(I);if(!M){let w=document.getElementById(I);if(w){let g=C.querySelector("defs");if(!g)g=document.createElementNS("http://www.w3.org/2000/svg","defs"),C.insertBefore(g,C.firstChild);M=w.cloneNode(!0),g.appendChild(M),G.add(g)}}if(M&&!G.has(M)){G.add(M);let w=M.parentNode;while(w&&w!==C)G.add(w),w=w.parentNode}}let y=F.getAttribute&&F.getAttribute("style");if(y){let U=y.match(/url\(#([^)]+)\)/g);if(U)for(let I of U){let M=I.match(/url\(#([^)]+)\)/);if(!M)continue;let w=M[1];if(!w)continue;let g=C.getElementById(w);if(g&&!G.has(g)){G.add(g);let i=g.parentNode;while(i&&i!==C)G.add(i),i=i.parentNode}}}let B=F.children;for(let U=0;U<B.length;U++){let I=B[U];if(I)Y(I)}}(T);let q=T.tagName&&T.tagName.toLowerCase();if(q==="tspan"||q==="textpath"){let Y=T.parentNode;if(Y){let F=Array.from(Y.children);for(let k of F){let W=k.tagName&&k.tagName.toLowerCase();if(W==="tspan"||W==="textpath")G.add(k),function y(B){G.add(B);let U=B.children;for(let I=0;I<U.length;I++){let M=U[I];if(M)y(M)}}(k)}}}(function Y(F){let k=Array.prototype.slice.call(F.children);for(let W=0;W<k.length;W++){let y=k[W];if((y.tagName&&y.tagName.toLowerCase())==="defs")continue;if(!G.has(y)&&!y.contains(T))y.parentNode.removeChild(y);else Y(y)}})(C);let D=new XMLSerializer().serializeToString(C),j=new Blob([D],{type:"image/svg+xml;charset=utf-8"}),X=URL.createObjectURL(j),A=new Image,m=null,R=null;try{if(A.decoding="async",A.crossOrigin="anonymous",A.src=X,await new Promise((Y,F)=>{let k=function(){A.onload=null,A.onerror=null,Y(void 0)},W=function(y){A.onload=null,A.onerror=null;let B=y&&typeof y==="object"&&"message"in y?String(y.message):"unknown error",U=n(J),I=e(J),M=s(J,K);F(Error(`❌ Failed to render SVG as image: ${B}

ELEMENT DETAILS:
  ${U}
  Font-family: ${I}
  SVG Root: ${K.id?`id="${K.id}"`:"(no id)"}
`+M+`
This can happen when:
  1. The SVG contains invalid XML syntax
  2. Referenced resources (images, fonts) failed to load
  3. The SVG uses unsupported features
  4. Browser security policies blocked the rendering

How to fix:
`+`  • Validate your SVG with an XML validator
`+`  • Check that all external resources (images, fonts) are accessible
`+`  • Ensure referenced elements (gradients, patterns, etc.) exist in <defs>
`+`  • If fonts are missing, ensure they are installed or embedded in the SVG
`+"  • Try simplifying the SVG to isolate the problematic element"))};A.onload=k,A.onerror=W}),m=document.createElement("canvas"),m.width=_,m.height=O,R=m.getContext("2d"),!R)throw Error("Failed to get canvas 2D context");R.clearRect(0,0,_,O),R.drawImage(A,0,0,_,O)}finally{URL.revokeObjectURL(X),A.src="",A.onload=null,A.onerror=null}let v;try{if(!R)throw Error("Canvas context is null");v=R.getImageData(0,0,_,O)}catch(Y){let F=Y instanceof Error?Y.message:"",k=/out of memory/i.test(F),W=/tainted/i.test(F);if(k){let I=n(J),M=s(J,K);throw Error(`❌ Cannot render SVG: Canvas out of memory
`+`
ELEMENT DETAILS:
  ${I}
  SVG Root: ${K.id?`id="${K.id}"`:"(no id)"}
`+M+`
The SVG coordinates or dimensions are too large for canvas rasterization.
Current viewBox: ${$.x} ${$.y} ${$.width} ${$.height}
Attempted canvas size: ${_}×${O} pixels

How to fix:
`+`  • Reduce the viewBox dimensions to a reasonable size (< 10,000 units)
`+`  • Use smaller coordinates (avoid values > 100,000)
`+`  • Decrease the pixelsPerUnit scaling factor
`+`  • Split large SVG into smaller regions and process separately
`+`
Original error: ${F}`)}if(W){let I=n(J),M=e(J),w=s(J,K);throw Error(`❌ Cannot read SVG pixels: Canvas is tainted by cross-origin resources
`+`
ELEMENT DETAILS:
  ${I}
  Font-family: ${M}
  SVG Root: ${K.id?`id="${K.id}"`:"(no id)"}
`+w+`
This happens when your SVG references external resources without CORS:
`+`  • External images (PNG, JPG, etc.) from different domains
`+`  • Web fonts from CDNs without proper CORS headers
`+`  • SVG <use> elements referencing external files
`+`
How to fix:
`+`  • Host images/fonts on the same domain as your page
`+`  • Configure CORS headers on external resources (Access-Control-Allow-Origin: *)
`+`  • Use data URLs for images instead of external URLs
`+`  • Embed fonts directly in the SVG using @font-face with data URLs
`+`  • If using web fonts (like "${M}"), ensure they have CORS headers or embed them

Original error: ${F}`)}let y=n(J),B=e(J),U=s(J,K);throw Error(`❌ Cannot read SVG pixels from canvas
`+`
ELEMENT DETAILS:
  ${y}
  Font-family: ${B}
  SVG Root: ${K.id?`id="${K.id}"`:"(no id)"}
`+U+`
Error: ${F||"unknown canvas error"}

Common causes:
`+`  • Cross-origin images/fonts without CORS (canvas becomes "tainted")
`+`  • Canvas size too large (out of memory)
`+`  • Browser security restrictions
`+`
How to fix:
`+`  • Check browser console for specific CORS errors
`+`  • Ensure all external resources are same-origin or have CORS enabled
`+"  • Try reducing the SVG size or complexity")}let a=v.data,P=_,p=-1,c=O,V=-1;for(let Y=0;Y<O;Y++){let F=Y*_*4;for(let k=0;k<_;k++){let W=F+k*4;if(a[W+3]!==0){if(k<P)P=k;if(k>p)p=k;if(Y<c)c=Y;if(Y>V)V=Y}}}if(p<P||V<c)return null;let u=$.x+P/H,b=$.y+c/H,x=(p-P+1)/H,h=(V-c+1)/H;return{x:u,y:b,width:x,height:h}}async function l(J,K){K=K||{};let Q=K.mode||"clipped",Z=typeof K.coarseFactor==="number"?K.coarseFactor:3,$=typeof K.fineFactor==="number"?K.fineFactor:24,S=typeof K.safetyMarginUser==="number"?K.safetyMarginUser:null,E=typeof K.useLayoutScale==="boolean"?K.useLayoutScale:!0,C=typeof K.fontTimeoutMs==="number"?K.fontTimeoutMs:5000,z=typeof J==="string"?document.getElementById(J):J;if(!z){let _=typeof J==="string"?`id="${J}"`:"provided reference";throw Error(`❌ Cannot compute SVG bounding box: Element not found
`+`
REQUESTED ELEMENT:
  ${_}
  Type: ${typeof J}

How to fix:
`+`  • Check that the element exists in the DOM
`+`  • Verify the element ID is correct (case-sensitive)
`+`  • Ensure the element hasn't been removed from the DOM
`+"  • If passing an element reference, make sure it's not null/undefined")}let N=d.get(z);if(N)await N;let L=(_)=>{},H=new Promise((_)=>{L=_});d.set(z,H);try{let _=z.ownerDocument||document;await JJ(_,C);let O=z.ownerSVGElement||(z instanceof SVGSVGElement?z:null);if(!O){let V=n(z),u=z&&z.id&&r(z.id)?`
⚠️  NOTE: This element has an AUTO-GENERATED ID ("${z.id}").
   This ID was added by sbb-extract.cjs and doesn't exist in your original SVG.

`:"";throw Error(`❌ Cannot compute SVG bounding box: Element is not inside an SVG tree
`+`
ELEMENT DETAILS:
  ${V}
`+u+`This element is not connected to an <svg> root element.

How to fix:
`+`  • Ensure the element is inside an <svg> tag in the DOM
`+`  • Check that you're not querying a detached/orphaned element
`+`  • If creating elements programmatically, append them to the SVG tree first
`+"  • Verify the element hasn't been removed from the document")}let T=O.viewBox&&O.viewBox.baseVal,G;if(T&&T.width&&T.height)G={x:T.x,y:T.y,width:T.width,height:T.height};else{let V=GJ(O);if(V)G={x:V.x,y:V.y,width:V.width,height:V.height};else G={x:-2000,y:-2000,width:4000,height:4000}}let f=[];(function V(u){let b=u.getAttribute&&u.getAttribute("xlink:href"),x=u.getAttribute&&u.getAttribute("href");for(let F of[b,x])if(F&&F.startsWith("#")){let k=F.substring(1),W=O.getElementById(k);if(W&&!f.includes(W))f.push(W)}let h=u.getAttribute&&u.getAttribute("style");if(h){let F=h.match(/url\(#([^)]+)\)/g);if(F)for(let k of F){let W=k.match(/url\(#([^)]+)\)/);if(!W)continue;let y=W[1];if(!y)continue;let B=O.getElementById(y);if(B&&!f.includes(B))f.push(B)}}let Y=u.children;for(let F=0;F<Y.length;F++)V(Y[F])})(z);let q;if(Q==="unclipped"){let{x:V,y:u}=G,b=G.x+G.width,x=G.y+G.height,h=KJ(O,G,O.getBoundingClientRect()),Y=(F)=>{try{let k=F.getBoundingClientRect(),W=O.getBoundingClientRect();if(k.width>0&&k.height>0){let y,B,U,I;if(h.uniform){let w=h.scale;y=G.x+(k.left-W.left-h.offsetX)*w,B=G.y+(k.top-W.top-h.offsetY)*w,U=G.x+(k.right-W.left-h.offsetX)*w,I=G.y+(k.bottom-W.top-h.offsetY)*w}else y=G.x+(k.left-W.left)*h.scaleX,B=G.y+(k.top-W.top)*h.scaleY,U=G.x+(k.right-W.left)*h.scaleX,I=G.y+(k.bottom-W.top)*h.scaleY;let M=200;V=Math.min(V,y-M),u=Math.min(u,B-M),b=Math.max(b,U+M),x=Math.max(x,I+M)}}catch{}};Y(z);for(let F of f)Y(F);q={x:V,y:u,width:b-V,height:x-u}}else q={x:G.x,y:G.y,width:G.width,height:G.height};let D=1;if(E&&G.width>0&&G.height>0){let V=O.getBoundingClientRect();if(V&&V.width>0&&V.height>0){let u=V.width/G.width,b=V.height/G.height;D=(u+b)/2}}let j=Math.max(1,D*Z),X=Math.max(4,D*$),A=await QJ(z,O,q,j);if(!A)return null;let m=S;if(m==null||!isFinite(m)){let V=Math.max(A.width,A.height);m=(V>0?V*0.25:0)+100}let R=A.x-m,v=A.y-m,a=A.x+A.width+m,P=A.y+A.height+m,p={x:R,y:v,width:Math.max(0,a-R),height:Math.max(0,P-v)};if(p.width<=0||p.height<=0)return null;let c=await QJ(z,O,p,X);if(!c)return null;return{x:c.x,y:c.y,width:c.width,height:c.height,element:z,svgRoot:O}}finally{L(),d.delete(z)}}async function ZJ(J,K){if(!Array.isArray(J)||J.length===0)throw Error(`Cannot compute union bounding box: Invalid targets parameter

Expected: Non-empty array of SVG elements or element IDs
Received: ${Array.isArray(J)?"empty array":typeof J}

How to fix:
`+`  • Pass an array with at least one element
`+`  • Example: ['element1', 'element2'] or [el1, el2]
`+"  • Ensure the array is not empty before calling this function");let Q=[],Z=null;for(let z=0;z<J.length;z++){let N=J[z];if(!N)continue;let L=await l(N,K);if(!L)continue;if(!Z)Z=L.svgRoot;else if(L.svgRoot!==Z){let H=Z.id?`id="${Z.id}"`:"(no id)",_=L.svgRoot.id?`id="${L.svgRoot.id}"`:"(no id)";throw Error(`Cannot compute union bounding box: Elements from different SVG documents

All elements must belong to the same <svg> root element.
Previous SVG: ${H}
Current SVG:  ${_}

How to fix:
`+`  • Ensure all elements are children of the same <svg> root
`+`  • If you have multiple SVGs, compute bbox for each separately
`+"  • Check that elements haven't been moved between different SVG trees")}Q.push(L)}if(Q.length===0)return null;let $=1/0,S=1/0,E=-1/0,C=-1/0;for(let z=0;z<Q.length;z++){let N=Q[z];if(!N)continue;$=Math.min($,N.x),S=Math.min(S,N.y),E=Math.max(E,N.x+N.width),C=Math.max(C,N.y+N.height)}if(!Z)return null;return{x:$,y:S,width:E-$,height:C-S,svgRoot:Z,bboxes:Q}}async function $J(J,K){K=K||{};let Q=Object.assign({},K,{mode:"clipped"}),Z=Object.assign({},K,{mode:"unclipped"}),$=await l(J,Q),S=await l(J,Z);return{visible:$,full:S}}async function CJ(J,K){K=K||{};let Q=typeof J==="string"?document.getElementById(J):J;if(!Q||!(Q instanceof SVGSVGElement)){let q=typeof J==="string"?`id="${J}"`:"provided reference";throw Error(`Cannot compute viewBox expansion: Invalid SVG root (${q})

Expected: Root <svg> element or its ID
Received: ${Q?Q.tagName:"null/undefined"}

How to fix:
`+`  • Pass the root <svg> element or its ID string
`+`  • Ensure the element is actually an <svg> tag, not a child element
`+"  • Check that the element exists in the DOM")}let Z=Q.viewBox&&Q.viewBox.baseVal;if(!Z||!Z.width||!Z.height){let q=Q.id?`id="${Q.id}"`:"(no id)";throw Error(`Cannot compute viewBox expansion: SVG missing valid viewBox (${q})

The root <svg> element must have a viewBox attribute with valid dimensions.
Current viewBox: ${Q.getAttribute("viewBox")||"(none)"}

How to fix:
`+`  • Add a viewBox attribute to your <svg> tag
`+`  • Example: <svg viewBox="0 0 800 600" ...>
`+`  • Ensure viewBox has 4 numbers: x, y, width, height
`+`  • Width and height must be greater than 0
`+"  • Use the sbb-fix-viewbox.cjs tool to auto-generate viewBox")}let $={x:Z.x,y:Z.y,width:Z.width,height:Z.height},S=await $J(Q,K),E=S.visible,C=S.full;if(!C)return null;let z=$.x+$.width,N=$.y+$.height,L=C.x+C.width,H=C.y+C.height,_=Math.max(0,$.x-C.x),O=Math.max(0,$.y-C.y),T=Math.max(0,L-z),G=Math.max(0,H-N),f={x:$.x-_,y:$.y-O,width:$.width+_+T,height:$.height+O+G};return{currentViewBox:$,visibleBBox:E,fullBBox:C,padding:{left:_,top:O,right:T,bottom:G},newViewBox:f}}async function _J(J,K){K=K||{};let Q=null;if(typeof J==="string"){if(Q=document.querySelector(J),!Q)throw Error(`SVG element not found: ${J}`)}else if(J instanceof Element)Q=J;else throw Error("Target must be a selector string or DOM element");if(Q.tagName.toLowerCase()==="object"&&"contentDocument"in Q&&Q.contentDocument){let x=Q.contentDocument.querySelector("svg");if(x)Q=x}else if(Q.tagName.toLowerCase()==="iframe"&&"contentDocument"in Q&&Q.contentDocument){let x=Q.contentDocument.querySelector("svg");if(x)Q=x}else if(Q.tagName.toLowerCase()==="use");if(!Q||!("ownerSVGElement"in Q)&&Q.tagName.toLowerCase()!=="svg")throw Error("Target is not an SVG element or does not contain SVG content");let Z=K.theme||"auto",$=!1;if(Z==="auto")$=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;else if(Z==="dark")$=!0;else if(Z==="light")$=!1;let S=$?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.6)",E=K.borderColor||S,C=K.borderWidth||"2px",z=K.borderStyle||"dashed",N=K.padding!==void 0?K.padding:4,L=K.zIndex!==void 0?K.zIndex:999999,H=K.bboxOptions||{},_=await l(Q,H);if(!_||_.width===0||_.height===0)return console.warn("showTrueBBoxBorder: Element has zero-size bounding box",_),{bbox:_,overlay:null,remove:()=>{}};let O=("ownerSVGElement"in Q?Q.ownerSVGElement:null)||Q,T=O.getBoundingClientRect(),G=O.viewBox.baseVal,f=0,q=0,D=T.width,j=T.height;if(G&&G.width>0&&G.height>0)f=G.x,q=G.y,D=G.width,j=G.height;let X=T.width/D,A=T.height/j,m=T.left+(_.x-f)*X-N,R=T.top+(_.y-q)*A-N,v=_.width*X+N*2,a=_.height*A+N*2,P=document.createElement("div");P.style.position="fixed",P.style.left=`${m}px`,P.style.top=`${R}px`,P.style.width=`${v}px`,P.style.height=`${a}px`,P.style.border=`${C} ${z} ${E}`,P.style.pointerEvents="none",P.style.zIndex=String(L),P.style.boxSizing="border-box",P.setAttribute("data-svg-bbox-overlay","true"),P.setAttribute("data-target-id",Q.id||"anonymous"),document.body.appendChild(P);let p=()=>{let b=O.getBoundingClientRect(),x=b.width/D,h=b.height/j,Y=b.left+(_.x-f)*x-N,F=b.top+(_.y-q)*h-N,k=_.width*x+N*2,W=_.height*h+N*2;P.style.left=`${Y}px`,P.style.top=`${F}px`,P.style.width=`${k}px`,P.style.height=`${W}px`},c=()=>p(),V=()=>p();return window.addEventListener("scroll",c,!0),window.addEventListener("resize",V),{bbox:_,overlay:P,remove:()=>{if(P.parentNode)P.parentNode.removeChild(P);window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",V)}}}async function jJ(J,K,Q){Q=Q||{};let Z={aspect:Q.aspect||"stretch",aspectRatioMode:Q.aspectRatioMode||"meet",align:Q.align||"xMidYMid",visibility:Q.visibility||"unchanged",visibilityList:Q.visibilityList||null,margin:Q.margin||0,saveVisibilityList:Q.saveVisibilityList||!1,dryRun:Q.dryRun||!1,bboxOptions:Q.bboxOptions||{}},$;if(typeof J==="string"){let q=J.startsWith("#")?J:"#"+J;if($=document.querySelector(q),!$)$=document.getElementById(J)}else $=J;if(!$||$.tagName.toLowerCase()!=="svg")throw Error("Target must be an SVG element");let S=Array.isArray(K)?K:[K];if(S.length===0)throw Error("At least one object ID must be provided");let E=S.map((q)=>{let D=document.getElementById(q);if(!D)throw Error(`Element with ID "${q}" not found`);if(D.tagName.toLowerCase()==="symbol"){let j=Array.from($.querySelectorAll("use")).filter((A)=>{return(A.getAttribute("href")||A.getAttributeNS("http://www.w3.org/1999/xlink","href"))==="#"+q});if(j.length===0)throw Error(`Symbol "${q}" has no <use> elements referencing it`);if(j.length>1)throw Error(`Symbol "${q}" is referenced by multiple <use> elements. Please specify the exact <use> element ID.`);let X=j[0];if(!X)throw Error(`Symbol "${q}" has no <use> elements referencing it`);D=X}return D}),C=Z.bboxOptions||{};await JJ(document,C.fontTimeoutMs||8000);let z;if(E.length===1){let q=E[0];if(!q)throw Error("No element found");z=await l(q,C)}else{let q=E.filter((D)=>D!=null);z=await ZJ(q,C)}if(!z||z.width<=0||z.height<=0)throw Error("Could not compute valid bounding box for specified objects");let N=$.viewBox.baseVal,L={x:N.x||0,y:N.y||0,width:N.width||parseFloat($.getAttribute("width")||"0")||0,height:N.height||parseFloat($.getAttribute("height")||"0")||0};if(L.width===0||L.height===0){let q=$.getBoundingClientRect();L.width=q.width,L.height=q.height}let H=0;if(typeof Z.margin==="string"){let q=Z.margin.match(/^([\d.]+)(px|%)?$/);if(q&&q[1]){let D=parseFloat(q[1]),j=q[2];if(j==="px"){let A=$.getBoundingClientRect().width/L.width;H=D/A}else if(j==="%"){let X=Math.sqrt(z.width*z.width+z.height*z.height);H=D/100*X}else H=D}}else H=Z.margin;let _;if(Z.aspect==="stretch")_={x:z.x-H,y:z.y-H,width:z.width+H*2,height:z.height+H*2};else if(Z.aspect==="changePosition"){let q=z.x+z.width/2,D=z.y+z.height/2;_={x:q-L.width/2,y:D-L.height/2,width:L.width,height:L.height}}else if(Z.aspect==="preserveAspectRatio"){let q=L.width/L.height,D=(z.width+H*2)/(z.height+H*2),j,X;if(Z.aspectRatioMode==="meet")if(q>D)X=z.height+H*2,j=X*q;else j=z.width+H*2,X=j/q;else if(q>D)j=z.width+H*2,X=j/q;else X=z.height+H*2,j=X*q;let A=z.x+z.width/2,m=z.y+z.height/2,R=Z.align.match(/^x(Min|Mid|Max)Y(Min|Mid|Max)$/),v=R?R[1]:"Mid",a=R?R[2]:"Mid",P,p;if(v==="Min")P=z.x-H;else if(v==="Max")P=z.x+z.width+H-j;else P=A-j/2;if(a==="Min")p=z.y-H;else if(a==="Max")p=z.y+z.height+H-X;else p=m-X/2;_={x:P,y:p,width:j,height:X}}else throw Error(`Unknown aspect mode: ${Z.aspect}`);let O=null;if(Z.saveVisibilityList){let q={};$.querySelectorAll("[id]").forEach((j)=>{if(j instanceof HTMLElement||j instanceof SVGElement){let X=window.getComputedStyle(j);q[j.id]={display:j.style.display||X.display,visibility:j.style.visibility||X.visibility,opacity:j.style.opacity||X.opacity}}}),O=q}let T={};if(Z.visibility!=="unchanged"&&!Z.dryRun){if(Z.visibility==="hideAllExcept")$.querySelectorAll("[id]").forEach((D)=>{if(D instanceof HTMLElement||D instanceof SVGElement){if(T[D.id]=D.style.display,!S.includes(D.id))D.style.display="none"}});else if(Z.visibility==="hideTargets")E.forEach((q)=>{if(q instanceof HTMLElement||typeof SVGElement<"u"&&q instanceof SVGElement)T[q.id]=q.style.display,q.style.display="none"});else if(Z.visibility==="restoreList"&&Z.visibilityList){let q=Z.visibilityList;Object.keys(q).forEach((D)=>{let j=document.getElementById(D);if(j){let X=q[D];if(!X)return;if(T[D]={display:j.style.display,visibility:j.style.visibility,opacity:j.style.opacity},X.display!==void 0)j.style.display=X.display;if(X.visibility!==void 0)j.style.visibility=X.visibility;if(X.opacity!==void 0)j.style.opacity=X.opacity}})}}let G=`${L.x} ${L.y} ${L.width} ${L.height}`;if(!Z.dryRun)$.setAttribute("viewBox",`${_.x} ${_.y} ${_.width} ${_.height}`);return{newViewBox:_,oldViewBox:L,bbox:z,visibilityList:O,restore:()=>{$.setAttribute("viewBox",G),Object.keys(T).forEach((q)=>{let D=document.getElementById(q);if(D){let j=T[q];if(!j)return;if(typeof j==="string")D.style.display=j;else{if(j.display!==void 0)D.style.display=j.display;if(j.visibility!==void 0)D.style.visibility=j.visibility;if(j.opacity!==void 0)D.style.opacity=j.opacity}}})}}}return{waitForDocumentFonts:JJ,getSvgElementVisualBBoxTwoPassAggressive:l,getSvgElementsUnionVisualBBox:ZJ,getSvgElementVisibleAndFullBBoxes:$J,getSvgRootViewBoxExpansionForFullDrawing:CJ,showTrueBBoxBorder:_J,setViewBoxOnObjects:jJ}})});export default kJ();
